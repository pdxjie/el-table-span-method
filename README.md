# Element UI 表格合并配置神器 🚀

> **终结手写 span-method 的痛苦！** 一个革命性的可视化工具，让复杂的表格单元格合并变得像拖拽文件一样简单。无论是财务报表、员工统计还是库存管理，再也不用为写合并逻辑而熬夜了！

## 🌟 为什么选择这个工具？

### 告别代码地狱
还在为写复杂的 span-method 函数发愁？这个工具让你：
- ⚡ **10秒导入数据** - 支持 JSON、CSV、Excel 多种格式
- 🎯 **可视化配置** - 点击鼠标就能完成复杂合并逻辑
- 👀 **实时预览** - 所见即所得，配置立即生效
- 📝 **一键生成代码** - Vue 2/3 代码自动生成，复制即用

### 功能强大到令人惊叹
- 🔥 **三种合并模式**：行合并、列合并、混合合并
- 🧠 **智能合并条件**：相同值合并 + 自定义 JavaScript 规则
- 📊 **多列同时合并**：一次配置多个列的合并规则
- 🎯 **精确范围控制**：指定起止行，精确控制合并范围
- 💻 **专业代码编辑器**：Monaco Editor 加持，语法高亮+智能提示
- 📱 **完美响应式设计**：手机、平板、桌面都能完美使用

## 🎮 快速体验

### 环境要求
- Node.js 16+
- 支持现代浏览器

### 30秒启动
```bash
git clone https://github.com/pdxjie/el-table-span-method.git
cd el-table-span-method
npm install
npm run dev
```
浏览器访问 `http://localhost:5173` 立即开始体验！

## 📚 完整功能指南

### 🔄 数据导入 - 支持一切你能想到的格式

**快速开始**
点击"使用示例数据"，立即体验 12 列复杂员工表的合并效果！

**文件上传**
- 📄 **JSON 格式**：完美支持嵌套对象和数组
- 📊 **CSV 格式**：自动识别分隔符和编码
- 📈 **Excel 格式**：支持 .xlsx/.xls，自动解析多工作表

**Excel 智能解析**
- 🎯 **智能表头识别**：自动分析并建议最佳表头行
- 👀 **原始数据预览**：A、B、C 列清晰展示，选择更准确
- 🔀 **多种解析方案**：系统提供多个解析选项供你选择
- ✅ **实时预览确认**：选择后立即预览解析结果

### ⚙️ 合并配置 - 比你想象的更强大

**合并类型选择**
- 🔗 **行合并**：相同值的行自动合并（最常用）
- ↔️ **列合并**：相同值的列横向合并
- 🌐 **混合合并**：行列同时合并的高级功能

**智能列选择**
- 📋 **多选支持**：一次选择多个列进行合并
- 🏷️ **标签展示**：已选列以标签形式清晰展示
- 🔄 **动态更新**：数据变化时自动更新可选列

**高级合并条件**
- ✅ **相同值合并**：完全相同的值才合并
- 🧩 **自定义规则**：JavaScript 表达式实现复杂逻辑
  - `value1.toLowerCase() === value2.toLowerCase()` - 忽略大小写
  - `Math.abs(value1 - value2) < 100` - 数值差小于100
  - `value1.includes(value2) || value2.includes(value1)` - 包含关系
  - 无限可能的自定义逻辑！

**精确范围控制**
- 📍 **起始行设置**：从第 N 行开始合并
- 🎯 **结束行设置**：到第 N 行结束合并
- 🔢 **数字输入框**：带增减按钮，操作更便捷
- ⚡ **实时验证**：输入范围自动验证，防止错误

### 👁️ 实时预览 - 所见即所得的极致体验

**智能表格展示**
- 📊 **动态列宽**：根据内容自动调整列宽
- 📏 **水平滚动**：超过6列自动启用滚动查看
- 🏷️ **智能提示**：显示数据行数和"可横向滚动"提示
- 🎨 **视觉优化**：合并单元格高亮显示

**表格交互功能**
- 🔄 **刷新按钮**：手动刷新预览效果
- 🖱️ **表头排序**：支持点击表头排序
- 💡 **溢出提示**：内容过长自动显示省略号和 tooltip
- 📱 **响应式适配**：手机端完美显示

**合并效果展示**
- ✅ **实时更新**：配置修改立即反映在预览中
- 🎯 **合并信息**：底部显示当前合并类型和列信息
- 🏷️ **状态标签**：成功、警告状态清晰展示

### 💻 代码生成 - 专业级代码输出

**双版本支持**
- ⚡ **Vue 3**：Composition API + `<script setup>` 语法
- 🔄 **Vue 2**：Options API + data/methods 结构
- 🔀 **一键切换**：在两个版本间自由切换

**Monaco Editor 编辑器**
- 🎨 **语法高亮**：JavaScript/Vue 语法完美高亮
- 💡 **智能提示**：代码补全和错误检测
- 📏 **代码折叠**：大文件浏览更轻松
- 🎯 **行号显示**：精确定位代码位置

**代码功能特性**
- 📋 **一键复制**：点击复制到剪贴板
- 💾 **文件下载**：直接下载为 .vue 文件
- 📊 **行数统计**：实时显示代码行数
- 🔧 **完整可用**：生成的代码开箱即用

**生成代码特点**
- ✅ **完整组件结构**：包含 template、script、style
- 🔧 **配置参数化**：合并列和条件自动配置
- 🛡️ **错误处理**：自定义规则异常捕获
- 📝 **代码注释**：关键逻辑清晰注释

### 📱 用户体验 - 每个细节都精心打磨

**现代化 UI 设计**
- 🎨 **Material Design**：现代简洁的设计风格
- 🌓 **柔和配色**：护眼的色彩搭配
- ✨ **微动画效果**：按钮悬停、页面切换动画
- 📱 **响应式布局**：完美适配各种屏幕

**操作反馈系统**
- ✅ **成功提示**：操作完成清晰提示
- ⚠️ **警告信息**：潜在问题及时提醒
- ❌ **错误处理**：友好的错误信息展示
- 📊 **进度指示**：文件处理进度实时显示

**性能优化**
- ⚡ **虚拟滚动**：大数据表格流畅滚动
- 🚀 **懒加载**：Monaco Editor 按需加载
- 💾 **内存优化**：文件处理内存控制
- ⏱️ **响应速度**：配置修改即时响应

## 🏆 实际应用场景

### 📊 企业报表管理
**场景**：财务月报需要按部门合并显示
```javascript
// 配置：选择"部门"列，行合并，相同值合并
// 结果：相同部门的数据自动合并，报表清晰美观
```

### 👥 人力资源统计
**场景**：员工信息按职级和部门双重合并
```javascript
// 配置：选择"职级"+"部门"，混合合并，自定义规则
// 结果：职级相同且部门相同的员工数据合并展示
```

### 📦 库存管理系统
**场景**：商品按分类合并，忽略大小写差异
```javascript
// 自定义规则：value1.toLowerCase() === value2.toLowerCase()
// 结果："Electronics" 和 "electronics" 识别为同一分类
```

### 📈 数据分析报告
**场景**：销售数据按时间段和地区合并
```javascript
// 配置：选择"时间段"+"地区"，指定范围第5-50行
// 结果：指定范围内的数据按双重条件合并
```

## 🛠️ 技术架构

### 前端技术栈
- **Vue 3**：最新的 Composition API
- **Element Plus**：企业级 UI 组件库
- **Monaco Editor**：VS Code 同款编辑器
- **Vite**：下一代前端构建工具
- **Modern CSS**：Flexbox + Grid 布局

### 核心算法
- **智能合并算法**：支持行、列、混合三种模式
- **自定义规则引擎**：安全的 JavaScript 表达式执行
- **文件解析引擎**：Papa Parse + XLSX 双引擎
- **虚拟滚动算法**：大数据表格性能优化

### 项目结构
```
src/
├── components/                 # 核心组件
│   ├── ConfigPanel.vue        # 配置面板 - 数据导入+合并设置
│   ├── TablePreview.vue       # 表格预览 - 实时效果展示
│   ├── CodeGenerator.vue      # 代码生成器 - Monaco Editor
│   └── ExcelHeaderSelector.vue # Excel表头选择器
├── utils/                     # 核心算法
│   ├── spanMethod.js         # 合并算法引擎
│   └── fileProcessor.js     # 文件处理引擎
├── style.css                # 全局样式
└── App.vue                  # 主应用
```

## 🎯 核心算法解析

### 行合并算法
```javascript
// 向下查找连续相同值，计算合并行数
// 向上检查是否为合并区域起始行
// 时间复杂度：O(n)，空间复杂度：O(1)
```

### 列合并算法
```javascript
// 横向查找相同值列，计算合并列数
// 检查是否为合并区域起始列
// 支持动态列数和非连续合并
```

### 混合合并算法
```javascript
// 先计算行合并，再计算列合并
// 验证合并矩形区域内所有值一致性
// 确保复杂场景下的合并准确性
```

### 自定义规则引擎
```javascript
// 安全的 Function 构造器执行用户代码
// 异常捕获和降级处理
// 支持复杂的 JavaScript 表达式
```

## 🚀 性能特性

### 文件处理性能
- **大文件支持**：最大支持 10MB 文件
- **流式处理**：分块读取，内存可控
- **智能识别**：自动识别文件格式和编码
- **错误恢复**：文件损坏时的智能修复

### 表格渲染性能
- **虚拟滚动**：万级数据流畅滚动
- **按需渲染**：只渲染可见区域
- **智能列宽**：根据内容动态调整
- **内存优化**：及时释放不用的数据

### 代码生成性能
- **模板缓存**：Vue 2/3 模板预编译
- **增量生成**：只重新生成变化部分
- **压缩优化**：生成代码自动压缩
- **语法检查**：实时语法验证

## 🎨 设计理念

### 用户体验第一
- **零学习成本**：拖拽即用，无需文档
- **所见即所得**：配置立即预览
- **错误可恢复**：任何操作都可撤销
- **跨平台一致**：各设备体验统一

### 专业工具品质
- **企业级稳定性**：异常处理和错误恢复
- **性能优先**：大数据场景优化
- **可扩展架构**：便于功能扩展
- **标准化输出**：生成符合规范的代码

## 🔍 常见问题解答

**Q: 支持多大的文件？**
A: 最大支持 10MB 文件，建议 Excel 文件不超过 10 万行，以确保最佳性能。

**Q: 生成的代码可以直接用在项目中吗？**
A: 完全可以！代码包含完整的 Vue 组件结构，只需要替换示例数据即可直接使用。

**Q: 自定义规则支持哪些 JavaScript 语法？**
A: 支持所有标准 JavaScript 表达式，包括字符串方法、数学运算、正则表达式等。

**Q: Excel 文件表头识别不准确怎么办？**
A: 系统会弹出表头选择界面，你可以手动选择正确的表头行，并实时预览解析效果。

**Q: 为什么表格列很多时无法看到所有列？**
A: 超过 6 列时会自动启用水平滚动，你可以拖动表格查看所有列，表头会显示"可横向滚动"提示。

**Q: 合并后的表格在手机上能正常显示吗？**
A: 完全支持！响应式设计确保在手机、平板上都有良好的使用体验。

## 💡 开发贡献

### 本地开发
```bash
# 克隆项目
git clone https://github.com/pdxjie/el-table-span-method.git
cd el-table-span-method

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 预览构建结果
npm run preview
```

### 项目规范
- **代码风格**：ESLint + Prettier
- **提交规范**：Conventional Commits

---

## 🎊 立即开始使用

别再为复杂的表格合并逻辑烦恼了！
- 🚀 **立即体验**：`npm run dev`
- 🐛 **问题反馈**：提交 Issue 或 PR
- ⭐ **点亮星标**：觉得好用记得给个 Star！

**让表格合并变得简单，让开发效率翻倍！** 🎯
